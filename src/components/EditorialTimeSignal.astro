---
---

<section class="editorial-time-signal" aria-label="Global Operations Time Zones">
  <div class="signal-content">
    <!-- 1) Primary Brand Statement -->
    <div class="brand-statement">
      BUILT ON 15+ YEARS OF EXPERIENCE — WORKING ACROSS TIME ZONES
    </div>

    <!-- 2) Secondary Time Display -->
    <div class="time-display">
      <div class="time-group">
        <span class="time-entry">PANAMA <span class="time-value" data-tz="America/Panama">--:--</span></span>
        <span class="separator">—</span>
        <span class="time-entry">PRAGUE <span class="time-value" data-tz="Europe/Prague">--:--</span></span>
      </div>
      <span class="separator desktop-only">—</span>
      <div class="time-group">
        <span class="time-entry">LONDON <span class="time-value" data-tz="Europe/London">--:--</span></span>
        <span class="separator">—</span>
        <span class="time-entry">MOSCOW <span class="time-value" data-tz="Europe/Moscow">--:--</span></span>
      </div>
    </div>

    <!-- 3) Heartbeat Line -->
    <div class="heartbeat-line"></div>
  </div>
</section>

<script>
  // Use a unique property on window to store our interval ID to prevent leaks
  const INTERVAL_KEY = '__editorialTimeSignalInterval';

  function initTimeSignal() {
    // Clear any existing interval first (just in case)
    if (window[INTERVAL_KEY]) {
      clearInterval(window[INTERVAL_KEY]);
      window[INTERVAL_KEY] = null;
    }

    const timeValues = document.querySelectorAll('.time-value');
    if (timeValues.length === 0) return;

    const formatters = {};

    function updateTime() {
      const now = new Date();

      timeValues.forEach(el => {
        const tz = el.getAttribute('data-tz');
        if (!tz) return;

        if (!formatters[tz]) {
          formatters[tz] = new Intl.DateTimeFormat('en-US', {
            timeZone: tz,
            hour: '2-digit',
            minute: '2-digit',
            hour12: false
          });
        }

        try {
            el.textContent = formatters[tz].format(now);
            el.style.opacity = '1';
        } catch (e) {
            console.error('Time formatting error', e);
        }
      });
    }

    // Initial update
    updateTime();

    // Align with the minute start
    const now = new Date();
    const msToNextMinute = (60 - now.getSeconds()) * 1000 - now.getMilliseconds() + 100;

    const timeoutId = setTimeout(() => {
        updateTime();
        // Set interval for 1 minute
        window[INTERVAL_KEY] = setInterval(updateTime, 60000);
    }, msToNextMinute);
  }

  document.addEventListener('astro:page-load', initTimeSignal);
</script>

<style>
  .editorial-time-signal {
    /* SPACING (VZDUCH) - Distinct separation from Hero CTA */
    margin-top: 7rem;
    padding: 0;
    background-color: transparent;
    font-family: 'Manrope', sans-serif;
    text-align: center;
    position: relative;
    z-index: 10;

    /* WIDTH & LAYOUT - 80% width logic */
    width: 80%;
    margin-left: auto;
    margin-right: auto;
  }

  .signal-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    /* SPACING - Gap between lines */
    gap: 1.5rem;
    width: 100%;
  }

  /* 1) Primary Line */
  .brand-statement {
    /* SIZE (UPSCALING) - Increased ~30% */
    font-size: clamp(1rem, 2vw, 1.125rem);
    font-weight: 600; /* SemiBold */
    text-transform: uppercase;
    letter-spacing: 0.08em;
    /* COLOR (PAPER & INK) - Muted, not pure white */
    color: var(--color-text);
    opacity: 0.7;
    line-height: 1.4;
  }

  /* 2) Secondary Line */
  .time-display {
    display: flex;
    flex-direction: column; /* Mobile: 2x2 via rows */
    align-items: center;
    gap: 0.75rem; /* Space between rows on mobile */
    /* SIZE (UPSCALING) - Increased ~30% */
    font-size: 1rem;
    font-weight: 600; /* SemiBold to support big title */
    /* COLOR (PAPER & INK) */
    color: var(--color-text);
    opacity: 0.7;
    font-variant-numeric: tabular-nums;
  }

  .time-group {
    display: flex;
    align-items: center;
    gap: 1.5rem; /* Generous space between items */
    justify-content: center;
    flex-wrap: wrap;
  }

  .time-entry {
    white-space: nowrap;
    text-transform: uppercase;
  }

  .separator {
    margin: 0 0.5rem;
    opacity: 0.5;
  }

  .desktop-only {
    display: none;
  }

  /* 3) Heartbeat Line */
  .heartbeat-line {
    height: 1px;
    /* WIDTH - 80% to match container context logic */
    width: 80%;
    background-color: var(--color-accent);
    margin-top: 1.5rem;
    opacity: 0.4;
    animation: heartbeat 2s ease-in-out infinite alternate;
  }

  @keyframes heartbeat {
    0% {
      opacity: 0.3;
      transform: scaleX(0.98);
    }
    100% {
      /* HEARTBEAT - Strong signal of life */
      opacity: 0.8;
      transform: scaleX(1.02);
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .heartbeat-line {
      animation: none;
      opacity: 0.6;
    }
  }

  /* Desktop Styles */
  @media (min-width: 768px) {
    .time-display {
      flex-direction: row;
      gap: 1.5rem;
    }

    .desktop-only {
      display: inline;
    }

    .time-group {
        gap: 0.5rem; /* Reset internal gap for single line flow if needed, or keep spacious */
    }
  }
</style>
